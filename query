SELECT DISTINCT
    citi_ov_roles_lobs.lob_name AS "lobName", 
    citi_ov_feats_subfeats.feature_group AS "featureGroup", 
    citi_ov_feats_subfeats.feature_name AS "featureName", 
    citi_ov_feats_subfeats_roles.role_name AS "roleName",
    citi_ov_feats_subfeats_sg_roles.sg_role AS "sgRole",
    citi_ov_feats_subfeats_sg_roles.resource_group AS "resourceGroup",
    citi_ov_feats_subfeats_sg_roles.decision AS "decision"
FROM 
    citi_ov_roles_lobs
INNER JOIN 
    citi_ov_feats_subfeats_roles 
    ON citi_ov_roles_lobs.role_name = citi_ov_feats_subfeats_roles.role_name
INNER JOIN 
    citi_ov_feats_subfeats 
    ON citi_ov_feats_subfeats.feature_name = citi_ov_feats_subfeats_roles.feature_name
INNER JOIN 
    citi_ov_feats_subfeats_sg_roles 
    ON citi_ov_feats_subfeats.feature_name = citi_ov_feats_subfeats_sg_roles.feature_name
WHERE 
    citi_ov_feats_subfeats.feature_group IN (:featureGroups)
    AND citi_ov_feats_subfeats_roles.role_name IN (:agentRoles)
    AND (
        (citi_ov_feats_subfeats_sg_roles.decision = 'selected' AND citi_ov_feats_subfeats_sg_roles.sg_role = :sgRole)
        OR
        (citi_ov_feats_subfeats_sg_roles.decision = 'inherited' AND citi_ov_feats_subfeats_sg_roles.sg_role IN (:sgAvailableRoles))
    )
=======================================================================================================================================

SELECT DISTINCT
    citi_ov_roles_lobs.lob_name AS "lobName",
    citi_ov_feats_subfeats.feature_group AS "featureGroup",
    citi_ov_feats_subfeats.feature_name AS "featureName",
    citi_ov_feats_subfeats_roles.role_name AS "roleName",
    citi_ov_feats_subfeats_relation.prod_group AS "prodGroup",
    citi_ov_feats_subfeats_relation.pid AS "pid",
    citi_ov_feats_subfeats_relation.caller_relation AS "callerRelation",
    citi_ov_feats_subfeats_sg_roles.sg_role AS "sgRole",
    citi_ov_feats_subfeats_sg_roles.resource_group AS "resourceGroup",
    citi_ov_feats_subfeats_sg_roles.decision AS "decision"
FROM 
    citi_ov_feats_subfeats_relation
INNER JOIN 
    citi_ov_feats_subfeats
    ON citi_ov_feats_subfeats_relation.feature_name = citi_ov_feats_subfeats.feature_name
INNER JOIN 
    citi_ov_feats_subfeats_roles
    ON citi_ov_feats_subfeats.feature_name = citi_ov_feats_subfeats_roles.feature_name
INNER JOIN 
    citi_ov_roles_lobs
    ON citi_ov_roles_lobs.role_name = citi_ov_feats_subfeats_roles.role_name
INNER JOIN 
    citi_ov_feats_subfeats_sg_roles
    ON citi_ov_feats_subfeats.feature_name = citi_ov_feats_subfeats_sg_roles.feature_name
WHERE 
    citi_ov_feats_subfeats.feature_group IN (:featureGroups)
    AND citi_ov_feats_subfeats_roles.role_name IN (:agentRoles)
    AND citi_ov_feats_subfeats_relation.caller_relation IN ('ALL', :callerRelation)
    AND citi_ov_feats_subfeats_relation.prod_group IN ('ALL', :prodGroup)
    AND citi_ov_feats_subfeats_relation.pid IN ('ALL', :pid)
    AND (
        (citi_ov_feats_subfeats_sg_roles.decision = 'selected' 
         AND citi_ov_feats_subfeats_sg_roles.sg_role IN ('ALL', :sgRole))
        OR
        (citi_ov_feats_subfeats_sg_roles.decision = 'inherited' 
         AND citi_ov_feats_subfeats_sg_roles.sg_role IN ('ALL', :sgAvailableRoles))
    )
